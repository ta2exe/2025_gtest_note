シラバス5章以降

# 第3部 ディープラーニングの応用

## 第24話 天才ステラの野望と、AIの心臓部

うさぎさんのクッキーショップの開店準備は、着々と進んでいました。
リスくんの描いたかわいい看板が取り付けられ、くまたんが作った自動ドアも完璧に動いています。森のみんなが完成を心待ちにする、平和で穏やかな時間が流れていました。

そんなある日の午後、くまたんの家に置いてあるホログラムディスクが、まばゆい光を放ちました。南極にいるペンギンさんからの緊急通信です。

『やあ、みんな！ 大変なことになったぞ！』
ホログラムのペンギンさんは、いつもよりずっと険しい顔をしていました。

『先日、南極で世界AIカンファレンスが開かれたんだが…そこで、DeepAppendix社のCEO、ステラがとんでもない新しいAIを発表したんだ』

DeepAppendix社――その名を聞いて、くまたんたちの間に緊張が走ります。ペンギンさんの話では、DeepPenguin社の創業者である友人ピーターを死に追いやったかもしれない、恐ろしいライバル企業です。

『その名は、「D-COOKIEアーキテクチャ」。あらゆる質問に答え、画像も音楽も作り出す、まるで万能AIだ。世界中の誰もが、その圧倒的な性能に熱狂している。だが、私にはわかる。あんなに都合のいい答えを出すAIなど、不自然すぎる。まるで、何か大きな悪意を隠しているように思えてならないんだ…』

ペンギンさんは、悔しそうに拳を握りました。
『ステラは…もともとピーターを生み出した、心優しい天才エンジニアだった。彼女もかつては、純粋にAIで世界を良くしようとしていたんだ。だが、効率と性能を追い求めるうちに、彼女は何か、とても大事なことを見失ってしまったのかもしれない…』

そのAIの何が危険なのかを理解してもらうため、ペンギンさんはくまたんたちの前に、新しいシミュレーション映像を映し出しました。
『これは、「森の仲間判定AI」の心臓部だ。ディープラーニングの基本、「ニューラルネットワーク」がどうやって物事を判断しているか、その仕組みそのものだよ』

映像には、森にある様々なもの――くまたん、うさぎさん、クッキー、切り株、石ころ――を表すアイコンが並んでいます。それぞれのアイコンからは、「甘いものが好き」「ふわふわしている」「動かない」といった、たくさんの「特徴」のアイコンに向かって、無数の線が伸びていました。

『この、すべての入力とすべての神経（ニューロン）が、網の目のように繋がっている部分が「**全結合層**」だ。そして、この一本一本の繋がりの強さこそが、AIの判断基準を決める、一番大事なパラメータ…「**重み**」なんだ』

くまたんが、おそるおそるホログラムに手を伸ばし、「甘いものが好き」という特徴と「クッキー」を繋ぐ線の「重み」をぐっと強くしてみました。すると、AIの最終判断を示すランプが、「仲間だ！」と力強く光ります。

「わっ！ AIがクッキーを仲間だって認めた！」
「今度は、『動かない』の重みを上げてみよう…ああっ、切り株が仲間になっちゃった！」

リスくんとうさぎさんも、夢中になっていろんな「重み」を調整し始めました。
AIの学習とは、この無数にある「重み」のバランスを、まるで巨大なオーケストラの指揮者のように、根気よく、繊細に調整していく作業なのだと、三人は肌で感じ取ります。

そして同時に、ペンギンさんの言っていた「恐ろしさ」の意味も、はっきりと理解しました。
もし、ステラが悪意を持って、この「重み」を調整していたとしたら？
世界中の人々を、気づかれないように、自分に都合のいい考え方へと導くことだって、できてしまうかもしれない…。

『D-COOKIEアーキテクチャの秘密を解き明かすには、AIがどうやって世界を見ているのか、もっと深く知る必要がある。』

ペンギンさんの言葉に、三人は強くうなずきました。
森の平和を守るため、そして、道を踏み外してしまった一人の天才の心を知るため、くまんたちの新しい冒険が、今、始まろうとしていました。

（第25話につづく）

## 第25話 伝説の草と、AIの「虫めがね」

ペンギンさんとの通信から数日後、森にはまた穏やかな日常が戻っていました。
くまたんたちは、ホログラムで「重み」を調整するシミュレーションを何度も試しながら、AIの判断基準が、ほんの少しのバランスで大きく変わってしまうことの面白さと、そして少しの恐ろしさを実感していました。

そんなある日、森の入り口の方から、のっそり、のっそりと、見慣れた大きな影が近づいてきました。
牛のイライザさんです。

「まあ、イライザさん！ お久しぶりですわ」
うさぎさんが駆け寄ると、イライザさんはおっとりと微笑みました。
「ごきげんよう、みなさん。また、この森にまいりました。どうやら私は、『伝説の草』を探すという目的を、まだ達成できていないようですから」

そう言うと、イライザさんは一枚の、古くて少しぼやけた写真を取り出しました。そこには、見たこともない、不思議な形をした草が写っています。
「あなた方は、この草について何か知りたいと思いますか？」
イライザさんの独特な問いかけに、くまたんたちは顔を見合わせ、元気よく「知りたい！」と答えました。

「うーん、でもこの写真、少しぼやけていて、どんな形なのかよくわからないや…」
絵の得意なリスくんが、スケッチブックを片手に首をかしげます。

その様子を、縁側で見ていたホワイトタイガーおばあちゃんが、にっこりと笑いました。
「ほう、それは面白い探しものじゃな。人間の目では難しいかもしれんが、AIの『目』なら、その草を見つけられるかもしれんぞ」

おばあちゃんは、ゆっくりと立ち上がると、一枚の紙に穴をあけた、手作りの「虫めがね」を持ってきました。
「前のAI（全結合層）は、いわば絵の全体を一度にぼんやりと見て、判断しようとしていた。じゃが、絵の得意なリスくん。お主は、絵を描くとき、まず何から見るかね？」

「えっと…まずは、花びらの丸い形とか、葉っぱのギザギザした線とか、そういう簡単な形から見ていくよ！」
「その通り！」
おばあちゃんは、深くうなずきました。
「それこそが、画像認識が得意なAI、『**畳み込みニューラルネットワーク（CNN）**』の考え方の基本じゃ。AIに、お主のような『専門家』の目を、たくさん持たせるんじゃよ」

おばあちゃんは、その手作り虫めがねを、ぼやけた写真の上にかざしました。
「この虫めがねが、AIの専門家の目…『**フィルタ**』（あるいは**カーネル**とも言う）じゃ。このフィルタは、たった一つのことしか見ない、頑固な専門家でな。『縦の線』を見つける専門家、『緑色』を見つける専門家など、たくさんの種類がおる」

おばあちゃんは、虫めがね（フィルタ）を写真の隅から隅へと、少しずつずらしながら動かしていきます。
「こうして、専門家が絵の全体をくまなく見て回る。この作業が、『**畳み込み操作**』じゃ」

「なるほど！ パトロールみたいだね！」
「そうじゃな。そして、専門家が自分の探している特徴を見つけるたびに、新しい真っ白な地図に『ここにあったぞ！』と印をつけていく。そうして出来上がったのが、『**特徴マップ**』というわけさ」

おばあちゃんは、くまたんたちに見せるように、地面に簡単な図を描きました。元のぼやけた写真から、「ギザギザの線」だけがくっきりと浮かび上がった、不思議な地図の絵です。

「わあ…！ これなら、元の写真がぼやけていても、草がどんな特徴を持っているか、分かりやすくなるね！」
くまたんが目を輝かせると、イライザさんは静かに言いました。
「まあ、AIは世界をそのように見ているのですね。あなた方は、なぜそれにそんなに心を動かされるのですか？」

その哲学的な問いに答えは出ませんでしたが、三人は、AIの賢い「目の付け所」に、ただただ感心するのでした。
D-COOKIEアーキテクチャの謎を解く第一歩は、このAIの「目」の仕組みを、もっと深く知ることにあるようです。

（第26話につづく）

## 第26話 虫めがねの歩幅と、優しい額縁

「なるほど…！ AIは、たくさんの専門家（フィルタ）を雇って、画像の中から特徴を探しているんだね！」
くまたんは、おばあちゃんの描いた「特徴マップ」を眺めながら、深くうなずきました。隣では、リスくんが自分のスケッチブックに、早速「ギザギザ線専門の虫めがね」の絵を描いています。

「でも、おばあちゃん」
くまたんは、少しもどかしそうに言いました。
「さっき、おばあちゃんが虫めがね（フィルタ）を動かしていた時、一歩ずつ、ちまちま動かしていたよね。もっとこう、大股でざっざって進めば、もっと速く調べられるんじゃないかな？」

「ふふふ、くまたんはせっかちじゃのう」
おばあちゃんは、楽しそうに笑いました。
「もちろん、それもできる。その『虫めがねの歩幅』のことを、AIの言葉で『**ストライド**』と言うんじゃ」

おばあちゃんは、今度は虫めがねを二歩分ずつ、ぴょんぴょんと飛ばすように動かしてみせました。
「ストライドを大きくすれば（歩幅を広げれば）、たしかにパトロールはすぐに終わる。じゃが、あまり大股で歩きすぎると、その間にあった小さな特徴を見逃してしまうかもしれん。逆に、ストライドを小さくすれば（歩幅を狭めれば）、時間はかかるが、より丁寧に特徴を探すことができる。どちらが良いかは、探したいものによって変わってくるんじゃよ」

「そっかぁ。速いけど大雑把なのと、丁寧だけど時間がかかるの、どっちも一長一短なんだね」
くまたんは納得しました。

すると今度は、うさぎさんが心配そうな顔で、写真の「端っこ」を指さしました。
「あの、おばあちゃん。虫めがねが写真のいちばん端っこに来たとき、レンズが半分くらい、はみ出しちゃってましたわ。これでは、隅っこにある大事な特徴を、ちゃんと見ることができないんじゃないかしら…？」

「まあ、うさぎ！ なんて素晴らしいところに気がついたんじゃ！」
おばあちゃんは、心から感心したように目を丸くしました。
「その通りじゃ。それを防ぐための、とても優しい工夫がある。それが、『**パディング**』じゃよ」

おばあちゃんは、そばにあったクッキーの箱から、四角いプレーンクッキーを何枚か取り出すと、イライザさんの写真の周りに、まるで額縁のようにおいていきました。

「こうして、もとの画像の周りに、意味のないデータ（この場合はクッキーじゃな）で縁取りをしてあげるんじゃ。そうすれば、虫めがねが端っこに来た時も、はみ出すことなく、画像の隅々まで、真ん中と同じようにしっかり見ることができるじゃろ？」

その光景は、まるで写真がクッキーの素敵な額縁に飾られているかのようでした。
「わあ、本当だ！ これなら安心ね！」
うさぎさんは、ぱっと顔を輝かせました。

「ストライドで歩幅を決めて、パディングで周りをしっかり守る…。AIの画像認識は、思ったよりもずっと、丁寧で thoughtful なのですね」
イライザさんが、静かにつぶやきます。

くまたんたちは、さっそく学んだことを活かして、ストライドを「1」、パディングを「あり」に設定して、もう一度「伝説の草」の特徴マップを作り直してみました。
すると、今度は前よりもずっと鮮明な特徴マップが出来上がり、葉っぱの縁にある、小さなトゲのような模様まで、はっきりと浮かび上がってきたのでした。

「やったあ！ これで、伝説の草のことが、また一つわかったぞ！」
くまたんの歓声が、穏やかな森の午後に響き渡りました。

（第27話につづく）

## 第27話 リスくんの壁画と、絵の具のバランス

うさぎさんのクッキーショップは、いよいよ開店間近。お店の壁には、リスくんが腕によりをかけて、大きな壁画を描くことになりました。テーマは「森の楽しいお茶会」です。

イライザさんは、くまたんたちが作った「伝説の草」の新しい特徴マップを静かに眺めていましたが、壁画を描き始めようとするリスくんに、おっとりと話しかけました。
「もしよろしければ、あなたに一つお願いがあります。その壁画に、この『伝説の草』も描いてはいただけませんか？ あなたの絵でそれを見ることができたら、私はとても嬉しく思います」

「もちろんだよ、イライザさん！」
少し難しいお願いでしたが、リスくんはにっこり笑ってうなずきました。

さっ-そく、リスくんは壁に向かいます。くまたん、うさぎさん、お茶会のテーブル、そして「伝説の草」…。森の仲間たちが、生き生きと描かれていきます。
しかし、しばらくして、リスくんの筆がぴたりと止まってしまいました。

「うーん…なんだか、絵がごちゃごちゃして見える…」
リスくんは、腕を組んで唸っています。
「イライザさんの草を力強く描いたら、今度はうさぎさんのクッキーの色が薄すぎて、全然美味しそうに見えない…。かといってクッキーの色を濃くすると、今度は背景の森が目立たなくなっちゃう…。絵の具の強さがバラバラで、まとまりがないんだ…」
リスくんは、すっかりスランプに陥ってしまいました。

その様子を見ていたホワイトタイガーおばあちゃんが、優しく声をかけます。
「おや、リスくん。それはAIの学習でも、まったく同じことが起きるんじゃよ」
「えっ、AIもスランプになるの？」

「そうじゃ。AIの専門家たち（フィルタ）が作った特徴マップも、いわばリスくんの絵の具と同じじゃ。ある専門家は『ギザギザを発見！』と大きな声（大きな数値）で報告し、別の専門家は『丸い形かも…』と小さな声（小さな数値）で報告する。報告の声の大きさが違いすぎると、AIはどの声を信じればいいか分からなくなって、学習がうまく進まなくなってしまうんじゃ」

「それを解決するのが、『**正規化層**』という、賢いお助け役じゃよ。バラバラになった声の大きさを、みんな同じくらいに揃えてくれる、『交通整理』のようなものじゃな」

おばあちゃんは、リスくんのパレットを指さしました。
「例えば、クッキーの絵を10枚描くとするじゃろ？ その10枚で使った『茶色』の平均的な濃さを計算して、それを基準にすべての茶色を調整する。これが『**バッチ正規化**』。バッチ（＝ひとまとまりのデータ）ごとに、色の濃さを揃える方法じゃ」

「なるほど！」
「あるいは、リスくんが今描いている、そのたった一枚の大きな壁画。その中で使われている赤、青、黄色…すべての色の濃さを見比べて、『この絵の中で、みんな仲良く目立つように調整しよう』と考えるのが『**レイヤー正規化**』じゃよ」

ヒントを得たリスくんの目に、ぱあっと輝きが戻りました。
「そっか！ まず、基本になる『色の濃さ』を決めて、パレットの上で全部の絵の具を同じくらいの鮮やかさに調整してから描けばいいんだ！」

リスくんが再び筆を取ると、今までの悩みが嘘のように、スラスラと壁画が描かれていきます。それぞれのモチーフがお互いを引き立てあい、調和のとれた、素晴らしい壁画が完成しました。
壁画の片隅で、不思議な輝きを放つ「伝説の草」も、森の仲間たちと楽しそうに笑っているのでした。

（第28話につづく）

## 第28話 情報の「まとめ上手」と、ゆずれない一番

リスくんの描いた素晴らしい壁画は、すっかり森の新しい名物になりました。
くまたんたちは、完成した壁画の前に集まり、自分たちの姿や、楽しそうなお茶会の様子を眺めて、うっとりしていました。

「それにしても、こうして見ると、イライザさんの『伝説の草』は、やっぱり不思議な形をしているね」
くまたんが壁画の隅を指さすと、みんなの視線がそこに集まります。

「ええ、そうですわね。この前の『特徴マップ』のおかげで、ギザギザした線や、小さなトゲがあることは分かりましたけれど…」
うさぎさんが言うと、リスくんが困ったようにスケッチブックをぱらぱらとめくりました。
「うん…。『ギザギザマップ』に『トゲマップ』、『丸いところマップ』…。専門家さんたちが頑張ってくれたおかげで地図はたくさんできたけど、今度は情報が多すぎて、結局この草がどんな形なのか、全体像がよく見えないんだ…」

その時、みんなの後ろから、ホワイトタイガーおばあちゃんの優しい声がしました。
「ふふふ、それもAIの学習が、次のステップに進むための大事な悩みじゃよ。たくさんの情報を、どうやって要約して、本質を見抜くか。そのための賢い仕組みが、『**プーリング層**』なんじゃ」

「ぷーりんぐ…？」
「そうじゃ。情報を賢く『まとめる』層、じゃな。例えば、このリスくんが作った『ギザギザマップ』。これを小さな四角いエリアにたくさん区切っていくんじゃ」

おばあちゃんは、地面に地図の絵を描き、それを碁盤の目のように区切ってみせました。
「そして、その小さなエリアごとに、コンテストを開くんじゃよ。『この中で、一番ギザギザしているのは誰だ！』とな」
「コンテスト？」

「そうじゃ。そして、そのコンテストで優勝した、一番強いギザギザの値だけを代表選手として選び、他の情報は思い切って捨ててしまう。これが、一番よく使われる『**最大値プーリング**』じゃ」

おばあちゃんの言葉に、三人は「ええっ！？」と驚きの声をあげました。
「情報を捨てちゃうなんてもったいない！」

「いいんじゃよ」とおばあちゃんはにっこり笑います。
「細かい情報を少し捨てることで、本当に大事な『一番強い特徴』だけが残る。おかげで、AIは画像の全体像を、もっと少ない計算で、素早く捉えることができるんじゃ」

「ちなみに、エリアの代表を一番強い子（最大値）ではなく、みんなの平均点で決める『**平均値プーリング**』という、もう少し穏やかな方法もあるぞい」

「へぇー！」
「そして、この『プーリング』には、もっとすごい魔法がある」
おばあちゃんは、イライザさんの写真が、少しだけ傾いていることに気がつきました。
「もし、この写真の草が、すこし右にずれていたらどうじゃろう？ 普通のAIなら、特徴の場所が違う！と混乱してしまうかもしれん」

「じゃが、プーリングを使えば、『このエリアの中に、強いギザギザがある』ということさえ分かれば、それがエリアの右にあるか左にあるかは、あまり気にしなくなる。少しくらいの位置のズレなら、ちゃんと『同じものだ』と認識してくれるんじゃよ。これを『**不変性の獲得**』と言う。AIが、とても柔軟な目を持つための、大事な工夫じゃ」

くまたんたちは、さっそく特徴マップに「最大値プーリング」を試してみました。
すると、あれほどごちゃごちゃして見えた地図が、きゅっと小さく、シンプルになりました。そして、そこには「伝説の草」の、今まで見えなかった全体のシルエットが、くっきりと浮かび上がっていたのです。

「すごい…！ これなら、どこを探せばいいか、見当がつくかもしれない！」
くまたんが歓声をあげると、イライザさんは静かに、そして嬉しそうに、こうつぶやくのでした。
「あなた方は、物事の本質を見抜く方法を、学んでいるのですね。それは、とても素晴らしいことですわ」

（第29話につづく）

## 第29話 絵描きの秘密と、賢い近道

「やったあ！ これで伝説の草の全体像がわかったぞ！」
くまたんが、プーリングによって要約された特徴マップを見て歓声をあげます。
しかし、絵描きのリスくんは、まだ少しだけ、考え込むような顔をしていました。

「どうしたんだい、リスくん？」
「うん…この地図、全体の形はすごくよくわかるんだけど…」
リスくんは、自分のスケッチブックと地図を見比べながら言いました。
「この前の『特徴マップ』にあった、葉っぱの産毛とか、茎のすじ模様みたいな、細かい線が全部消えちゃってるんだ。これじゃ、本物を見つけるときに見分けがつかないかもしれないよ…」

「なるほどな」
リスくんの言葉に、ホワイトタイガーおばあちゃんは深くうなずきました。
「要約（プーリング）のおかげで本質は見やすくなったが、その代償に細部の情報が失われてしまった、ということじゃな」

「じゃあ、もっとたくさんの畳み込み層とプーリング層を、何百層も重ねていけば、AIはもっともっと賢くなって、全部まとめて解決できるんじゃないかな？」
くまたんが、目を輝かせながら言いました。

「ふふふ、それは良い考えのようじゃが、実は大きなワナがあるんじゃよ」
おばあちゃんは、悪戯っぽく笑いました。
「AIの層を深くしすぎると、まるで伝言ゲームのようになってしまう。最初の層が見つけた大事な情報（伝言）が、たくさんの層を通り過ぎるうちに、だんだんぼやけて、最後には消えてしまうんじゃ（勾配消失問題）。これでは、深くした意味がなくなってしまう」

「ええーっ、じゃあどうすればいいの！？」
「そこで、リスくん。お主に聞きたい」
おばあちゃんは、リスくんのスケッチブックを指さしました。
「お主が、細かい風景画を描くとき、どうするかな？ 下書きを描いて、その上から色を塗って、さらに影をつけて…と、どんどん描き加えていくじゃろう。その時、最後に影をつける段階で、一番最初の下書きの線が、もう見えなくなっておるか？」

「ううん、そんなことないよ！」
リスくんは、首を横に振りました。
「僕は、色を塗るときも、いつでも一番最初の下書きの線を見ながら、『全体のバランスは崩れていないかな？』って確認しながら描くんだ。下書きは、最後までずっと大事な道しるべだよ」

「それじゃ！」
おばあちゃんは、ポンと手を打ちました。
「それこそが、AIをさらに賢くする、最高のヒント『**スキップ結合**』なんじゃ！」

おばあちゃんは、地面に何層もの四角を描くと、最初の層から最後の層に向かって、いくつかの層を飛び越えるような、大きな近道（バイパス）の矢印を描きました。
「こうして、初期の層が見つけた大事な情報（リスくんの下書き）を、いくつかの処理をスキップさせて、後の層に直接届けてあげるんじゃ。そうすれば、伝言ゲームの途中で情報が消えてしまう心配がない」

「すごい！ まさに近道だね！」
「そして、近道で送られてきた『下書き』情報を受け取った後の層は、もう一度ゼロから絵を描く必要がなくなる。『下書きに、どんな情報を描き足せば、もっと絵が良くなるか』という、その差分だけを学習すればよくなるんじゃ。この賢い仕組みを使ったネットワークが、『**Residual Network (ResNet)**』と呼ばれておるよ」

三人は、リスくんの絵描きの秘密が、最新のAI技術と全く同じ考え方だったことに、深く感動しました。
さっそく、くまたんたちはスキップ結合の仕組みをAIに取り入れ、もう一度「伝説の草」の画像を解析させます。

すると、画面には、今までで一番鮮明な「伝説の草」の姿が映し出されました。プーリングで得られた全体のシルエットと、スキップ結合で守られた細かい産毛や葉脈の模様。その両方が、完璧に表現されていたのです。

「これなら…これならきっと、本物を見つけられるぞ！」
くまたんの力強い声が、森に響き渡るのでした。

（第30話につづく）

# 第4部 時間をめぐる冒険

## 第30話 思い出のドーナツと、時間を旅するAI

うさぎさんのクッキーショップは、ついに完成の日を迎え、森の仲間たちを招いた、ささやかなお茶会が開かれていました。
お店に並ぶのは、色とりどりのクッキーたち。そしてテーブルの真ん中には、おばあちゃんのリクエストに応えてうさぎさんが特別に作った、揚げたてのドーナツクッキーが湯気を立てています。

「まあ、うさぎ。これは、わしの思い出の味そのものじゃわい」
ドーナツを一口食べたホワイトタイガーおばあちゃんは、紅茶のカップを手に、ふっと懐かしそうに目を細めました。

「思い出の味、ですって？」
「そうじゃ。昔、わしがMITTO大学で数学を教えていた頃…」
おばあちゃんは、少しだけ真剣な顔になると、最近ペンギンさんから聞いた「ステラ」という名前が、ずっと心に引っかかっていたことを打ち明けました。

「まさかとは思うたんじゃが、調べてみたら、やはりそうじゃった。わしの位相幾何学の講座に、いつも一番前の席でドーナツを頬張りながら、大人顔負けの質問をしてきた、あの天才少女のステラ本人じゃった…。当時のあの子は、自分の才能を世界のために使うのだと、キラキラした目で語っておった。今の、あの氷のように冷たいCEOの姿とは、とても結びつかん…」

おばあちゃんの言葉に、みんなは静まり返ります。
その時、くまたんがぽつりと言いました。
「人の過去と今が繋がっているように、AIにも、出来事の順番…つまり『物語』を理解できる能力ってあるのかな？」

その問いに、おばあちゃんは、はっとしたように顔を上げ、そして優しく微笑みました。
「良いところに気がついたね、くまたん。それこそが、これから私たちが学ぶ、新しいAIの扉じゃ。『**リカレントニューラルネットワーク（RNN）**』…時間を旅するAIの話をしようかの」

おばあちゃんは、目の前のドーナツを指さしました。
「これまでのCNNは、いわば、揚がったドーナツという『一枚の完成写真』を見るのが得意じゃった。じゃがRNNは、『生地が膨らんで、きつね色になって、お砂糖がまぶされる』というような、**時間の流れ（時系列データ）**を持つ物語を理解するのが得意なんじゃ」

「どうやって？」
「RNNの心臓部にはな、『**回帰結合層**』という、面白い仕組みがある」
おばあちゃんは、指でくるりと円を描いてみせました。
「それは、まるで自分自身の、ほんの少し前の記憶を、今の自分にそっと囁きかけるような回路なんじゃよ。『さっき、生地がちょっと膨らみすぎたぞ』という過去の情報を、今の『油で揚げる』という作業にフィードバックする。そうやって、RNNは前後の文脈を読み解いていくんじゃ」

ステラの過去と現在。
その、あまりに変わり果てた「物語」の謎を解くには、このRNNの力が必要不可欠かもしれない。
くまたんたちは、紅茶の湯気の向こうに、まだ見ぬAIの新しい可能性と、一人の天才がたどった哀しい時間の流れを、垣間見るのでした。

（第31話につづく）

## 第31話 AI探偵のタイムトラベルと、消えゆく記憶

「時間を旅するAI、かぁ…」
くまたんは、すっかり冷めてしまった紅茶のカップを見つめながら、わくわくした声で言いました。
「おばあちゃん、もっと詳しく教えて！ RNNはどうやって、前の出来事を覚えているの？」

「ふむ。では、もっと分かりやすい例で話そうかの」
おばあちゃんは、テーブルの上のクッキーで、簡単な文章を作りました。
「『うさぎさんの』『クッキーは』『おいしい』…この三つの言葉でできた、短い物語じゃ」

「AIに、『うさぎさんの』『クッキーは』と教えたあと、『おいしい』という次の言葉を予測させるには、AIは『クッキー』という言葉を覚えておらねばならん。そのための記憶の仕組みに、いくつか種類があるんじゃ」
おばあちゃんは、地面に二つの簡単な図を描きました。
「一つは、『直前に自分が何を考えていたか（隠れ層の状態）』を記憶の頼りにする方法。これが一番標準的な『**エルマンネットワーク**』じゃ。もう一つは、『直前に自分が何と答えたか（出力）』を参考にする『**ジョルダンネットワーク**』。どちらも、過去の自分を振り返って、今を判断する賢い仕組みじゃよ」

「なるほどー！」
「では、どうやってAIは『正しい記憶』を学ぶと思うかね？」
おばあちゃんの問いに、うさぎさんが手をぽんと打ちました。
「あっ、わかったわ！ 前にやった、AI探偵の『逆戻り大作戦』ね！」

「その通り！」
おばあちゃんは満足そうにうなずきます。
「RNNの学習方法は、まさしくAI探偵のタイムトラベルじゃ。AIが予測を間違えた時（『クッキーは、かわいい』と言ってしまった時など）、探偵は『おいしい』という正解とのズレを手がかりに、時間をさかのぼって間違いの原因を探しにいく。『クッキーは』の記憶は正しかったか、『うさぎさんの』の記憶は…とな。これを『**Back Propagation Through Time (BPTT)**』…時間をさかのぼる誤差逆伝播法、と呼ぶんじゃ」

「かっこいい！ AI探偵がタイムトラベル！」
くまたんが興奮する一方で、おばあちゃんは少しだけ、難しい顔をしました。
「じゃが、このAI探偵には、一つだけ大きな弱点がある。あまりに長い時間を、さかのぼりすぎると…」

おばあちゃんは、遠い目をして語り始めました。
「例えば、ステラの人生という、とても長い物語をAIに理解させたいとする。今の彼女の行動が、幼い頃の、ずっと昔の出来事に原因があったとしても、AI探偵はそこまでさかのぼるうちに、疲れ果ててしまうんじゃ」

「疲れ果てて…？」
「そう。時間をさかのぼればさかのぼるほど、間違いのヒント（勾配）はどんどん小さく、かすかになって、最後には完全に消えてしまう。これがあの恐ろしい『**勾配消失問題**』。遠い過去の記憶から何も学べなくなってしまう、AIの記憶喪失じゃ」

「逆に、パニックになることもある。ほんの些細な間違いじゃったのに、時間をさかのぼるうちに勘違いが膨れ上がって、『すべての原因は、一番最初の、あの出来事のせいだ！』と、とんでもない結論を出してしまう。これが『**勾配爆発問題**』。学習が大混乱に陥ってしまうんじゃ」

AI探偵のタイムトラベルには、そんなにも切ない弱点があったなんて。
これでは、ステラの心の奥底にある、遠い過去の真実にたどり着くことはできないかもしれない…。
くまたんたちは、単純なRNNの限界を知り、もっと優れた記憶の仕組みが、この森のどこかにあるはずだと、強く思うのでした。

（第32話につづく）

## 第32話 物忘れしない記憶箱と、賢い門番たち

「AIの記憶喪失、かぁ…」
くまたんは、すっかりしょんぼりしていました。
「これじゃ、ステラさんの子供の頃の、キラキラした夢のことなんて、AI探偵は今の彼女の姿にたどり着く前に、ぜんぶ忘れちゃうよ…」
うさぎさんもリスくんも、悲しい顔でうなずきます。

その様子を見ていたホワイトタイガーおばあちゃんは、ふふふ、と優しく笑いました。
「心配はいらんよ。わしら生き物だって、昨日の夕飯のことは忘れても、子供の頃の、一番大事な宝物のことは、ずっと忘れんじゃろ？ AIにも、それを実現する、特別な仕組みがあるんじゃ」

おばあちゃんは、お店の片隅に置いてあった、自分の古い研究道具が入った木箱を指さしました。
「これは、わしが何十年も研究を続けてこられた秘密…『魔法の記憶箱』じゃよ。AIの世界で言う、『**Long Short Term Memory (LSTM)**』という仕組みに、そっくりでのう」

「ろんぐ・しょーと・たーむ・めもりー？」
「そうじゃ。『長い（Long）』記憶を、『短い（Short Term）』時間の中で、うまく使う仕組み、という意味じゃな」

おばあちゃんは、箱のふたを開けてみせました。
「この箱の中にはな、大事な情報をずっと忘れないための、『魔法のベルトコンベア』が流れておる。そして、その流れを管理する、三人の賢い『門番』がおるんじゃ」
「門番！？」

「一人目は、『忘却門番』じゃ」
おばあちゃんは、箱から少し色あせたメモを取り出しました。
「この門番は、ベルトコンベアで流れてくる古い情報を見て、『この情報は、もう今の研究には必要ないのう』と判断したら、思い切って捨ててくれるんじゃ。おかげで、箱の中はいつもスッキリじゃ」

「二人目は、『入力門番』」
「この門番は、新しく入ってきた情報を見て、『これは未来の研究に役立つ、大事な発見じゃ！』と判断したら、ベルトコンベアに乗せてくれる。何を記憶し、何を無視するかを決める、重要な役じゃな」

「そして三人目が、『出力門番』」
「最後のこの門番は、今のわしが悩んでいる問題を見て、ベルトコンベアの中から、それに関係のある情報だけを、そっと取り出して見せてくれるんじゃよ」

忘れる情報、覚える情報、そして今使う情報。
その三人の賢い門番（**ゲート機構**）が協力してくれるおかげで、LSTMという記憶箱は、遠い過去の大事な記憶を失うことなく、現在の問題解決に役立てることができるのでした。

「すごい！ それなら、AI探偵も記憶喪失にならないね！」
くまたんが目を輝かせると、おばあちゃんは付け加えます。
「ちなみに、最近では、『忘却門番』と『入力門番』の仕事を一人でこなす、『更新門番』という、少しシンプルで効率的な仕組みも人気じゃよ。それが『**Gated Recurrent Unit (GRU)**』じゃ」

三人は、顔を見合わせました。希望の光が見えてきました。
これなら、AI探負は、ステラさんの長い人生という旅を、途中で記憶を失うことなく、最後までしっかりと見届けることができるかもしれない。

「よし！ ぼくたちのAI探偵に、この魔法の記憶箱を搭載しよう！」
くまたんの力強い声に、みんなは大きくうなずきました。
ステラの心に隠された、本当の物語を探す旅が、いよいよ始まろうとしていました。

（第33話につづく）

## 第33話 AI司書と、思い出への光のしるし

魔法の記憶箱（LSTM）を手に入れたくまたんたちは、さっそくペンギンさんから送ってもらった、ステラに関する膨大なデータをAI探偵に読み込ませました。彼女が大学時代に書いた論文、昔のインタビュー記事、DeepAppendix社の設立趣意書…。

しばらくして、AI探偵は一つの要約文を出力しました。
『ステラは、ある時期から、効率性をなによりも重視するようになったようです』

「うーん…」
くまたんは、その当たり障りのない答えに、首をかしげました。
「知りたいのは、どうしてそうなったのか、その『きっかけ』なんだけどなあ…」
AIは、ステラの長い人生という物語を、たった一行の感想文にまとめてしまったかのようでした。

「無理もないわい」
ホワイトタイガーおばあちゃんは、静かに言いました。
「今のAI探偵は、いわば、長い長い物語をぜんぶ読んだあと、本をすべて閉じてから、たった一つの記憶を頼りに感想を言っておるようなものじゃ。これでは、大事な詳細が抜け落ちてしまうじゃろう」

「じゃあ、どうすればいいの？」
「AIに、『超優秀な図書館の司書』になってもらうんじゃよ。それこそが、現代のAIを飛躍的に賢くした、魔法の仕組み…『**Attention**』なんじゃ」

おばあちゃんは、うさぎさんのお店の本棚を指さしました。
「例えば、くまたんが、この図書館で『ステラが悲しかった出来事』について調べたいとする。その調べたいこと（**クエリ**）を、司書に伝えるんじゃ」

「司書は、まず図書館にあるすべての本の背表紙（**キー**）をざっと見て、『悲しい出来事』というクエリと、関係がありそうな本に、重要度に応じて点数をつけていく」

「そして、点数が高かった本だけを何冊か選び抜き、その中身（**バリュー**）を、くまたんのために詳しく読み上げてくれる。これが、AIが情報の特定の部分に『注目（Attention）』する、ということの正体じゃ」

これまでのAI（**Seq2Seq**モデル）は、すべての本を律儀に読んでから、一つの記憶だけで答えようとしていた。
しかしAttentionを搭載したAI司書は、質問（クエリ）に応じて、膨大な記憶（本の山）の中から、関係の深い情報（キーとバリュー）だけを動的に選び出して、答えを組み立てることができるのでした。

「すごい！ それなら、本当に大事なことだけを、詳しく教えてくれるんだね！」
くまたんたちは、すぐさまAI探偵を「AI司書」にアップグレードしました。
そして、もう一度、問いかけます。
「教えて、AI司-書！ どうしてステラは、あんなに変わってしまったの？」

すると、AIの画面に、ステラの人生年表の中から、いくつかの出来事が、まるで光るしるしのように浮かび上がりました。

『MITTO大学時代、あるプロジェクトが非効率なせいで失敗し、大切な何かを失った経験』
『友人ピーターとの、AIの理想像をめぐる、決定的な意見の対立』
『論文『ドーナツの穴と宇宙の構造』の発表』

最後の項目に、おばあちゃんの目が、ぴくりと動きました。
くまたんたちは、ついにステラの心の謎を解く、重要な手がかりを見つけ出したのです。
AIの歴史を大きく変えたこの「Attention」という仕組みが、今、森の仲間たちを、一人の天才の、閉ざされた記憶の扉へと導こうとしていました。

（第34話につづく）

## 第34話 司書団がつむぐ物語と、AIの革命

AI司書が示してくれた、三つの光るしるし。
くまたんたちは、その三つの出来事をスケッチブックに書き出し、じっと見つめていました。

『プロジェクトの失敗』
『ピーターとの決別』
『ドーナツ論文』

「うーん…」リスくんが、首をかしげます。
「一つ一つは、ステラさんにとって大事な出来事だったってことはわかるんだけど…。どうして、この三つが繋がるのかが、まだよくわからないや」
AI司書は優秀ですが、それぞれの出来事の、深い関係性までは教えてはくれませんでした。

「そうじゃのう」
ホワイトタイガーおばあちゃんは、うなずきました。
「今のAI司書は、いわば一人の歴史学者じゃ。客観的な事実は見つけてくれるが、その裏にある、人の心の複雑な綾までは、なかなか読み解けん」

「では、どうすれば…？」
「一人の司書でダメなら、チームを組めばいいんじゃよ。それこそが、AIの歴史に革命を起こした、最強の発明…『**Transformer**』なんじゃからな」

「とらんすふぉーまー？」
「そうじゃ。一人の優秀な司書（Attention）に頼るのではなく、それぞれ専門分野が違う、たくさんの司書でドリームチームを結成するんじゃ！」
おばあちゃんの目に、力がこもります。

「例えば、『失敗したプロジェクト』という一つの出来事に対しても、『工学の司書』は技術的な問題点を、『心理学の司書』はステラの感じた挫折感を、『歴史の司書』は当時の時代背景を、それぞれ違う視点から分析する。この、たくさんの専門家の目で同時に物事を見る仕組みが、『**Multi-Head Attention**』じゃ」

「すごい！ いろんな角度から見れるんだね！」
「そして、Transformerの本当のすごさは、ここからじゃ」
おばあちゃんは、にやりと笑いました。
「その司書たちは、黙って一人で仕事をするだけじゃない。お互いに、見つけた情報について、ひそひそと相談を始めるんじゃよ」

『心理学の司書』が、『ピーターとの決別』の記録から、ステラの強い孤独感を見つけたとしよう。すると、すかさず『工学の司書』に尋ねるんじゃ。『もしもし、あなたが調べているプロジェクト失敗の記録に、この孤独感を強めるような記述はありませんかな？』と。これが、『**Self-Attention**』。情報たちが、自分たちで関連性を見つけ出し、結びついていく仕組みじゃ」

これまでのRNNは、物語を最初から一語一語、順番に読んでいくことしかできなかった。
しかしTransformerは、物語のすべてのページを一度に広げ、どの単語とどの単語が、ページを飛び越えて深く関係しているかを、一瞬で見抜くことができるのでした。

「ただし、順番がバラバラだと意味がわからなくなるからな、『これは1ページ目の言葉』『これは50ページ目の言葉』というふうに、ちゃんと場所の情報を教えてあげる必要もある。それが『**位置エンコーディング**』じゃ」

くまたんたちは、ゴクリと唾を飲み込みました。
そして、AI司書を、最強の「AI司書団（Transformer）」に進化させ、最後の質問を投げかけます。
「教えて！ この三つの出来事は、どう繋がっているの？」

AIの画面に、三つの出来事が再び表示されました。しかし、今度は、その間を繋ぐように、力強い線が引かれています。

『プロジェクトの失敗による**深い喪失感**が、友人ピーターとの**理想主義的な思想との決別**を促した。その結果、彼女は、より現実的で、確実な答えを求めるようになり、その探求が、観念的でありながらも一つの完成された世界を示す**『ドーナ-ツ論文』へと繋がった**』

それは、AIが初めて紡ぎだした、ステラの心の「物語」でした。
なぜ彼女が効率性を求めるようになったのか、その理由が、痛いほど伝わってきます。

「そうか…ステラさんは、ただ、もう二度と、大切なものを失いたくなかっただけなのかもしれない…」
うさぎさんが、そっとつぶやきました。
森の仲間たちは、ついに、一人の天才の、孤独な心の旅の、始まりを知るのでした。

（第35話につづく）

## 第35話 心のミニチュア像と、魔法の彫刻家

AI司書団（Transformer）が紡いだ物語によって、ステラの過去を知った森の仲間たちは、静かな衝撃を受けていました。
彼女は、ただ冷酷なだけのCEOではなかった。その心の奥底には、深い悲しみと、失われた理想があったのです。

「ステラさんの気持ち、少しだけわかった気がする…」
うさぎさんが、そっとつぶやきました。
「でも、これからどうすればいいんだろう？ 彼女の心は、たくさんの出来事や感情で、複雑に絡み合っているように見えるわ」

その言葉に、くまたんも深くうなずきます。
「うん…。ステラさんの心の、一番大事な『本質』の部分だけを、取り出して見ることはできないのかな？」

その問いを聞いていたホワイトタイガーおばあちゃんは、優しく微笑みました。
「くまたん、それはAIの一番面白いテーマの一つじゃよ。複雑な情報の中から、どうやって『本質的な特徴』だけを抜き出すか。それを専門とする、魔法の彫刻家のようなAIがおるんじゃ」

「魔法の彫刻家？」
「その名を、『**オートエンコーダ**』と言う」

おばあちゃんは、お茶会のテーブルの上に、粘土で大きくて複雑な形をした塊を作りました。
「これが、ステラの心のすべてを表す、巨大な彫像じゃとする。オートエンコーダは、二人の彫刻家でできている。一人目の『エンコーダ（符号化する者）』は、この巨大な彫像を、ぎゅぎゅーっと圧縮して、手のひらに乗るくらいの、小さな『ミニチュア像』に作り変えようとするんじゃ」

「そんなことできるの？」
「もちろん、そのためには、細かい飾りや、あまり重要でない部分は、思い切って削ぎ落とさねばならん。つまり、このミニチュア像には、元の彫像の『本質』だけが、凝縮されることになる。これを『**次元削減**』と言うんじゃよ」

「そして、二人目の彫刻家『デコーダ（復号する者）』は、その小さなミニチュア像だけをヒントに、もう一度、元の巨大な彫像を復元しようと試みる」

「わかった！ デコーダが復元した彫像が、元の彫像とそっくりだったら、エンコーダが作ったミニチュア像は、本質を完璧に捉えていたってことだね！」
くまたんの答えに、おばあちゃんは満足そうにうなずきました。

「さらに賢い彫刻家もおるぞい」とおばあちゃんは続けます。
「エンコーダとデコーダが何人もチームを組んで、ミニチュアをどんどん小さくしていく『**積層オートエンコーダ**』や…」
「カチッとした一つのミニチュアではなく、『少しだけ表情が違う、いろんなパターンのミニチュア』を作れる魔法のレシピを生み出す、『**変分オートエンコーダ (VAE)**』というものもある。これを使えば、新しい『ステラらしい心』の形を、生み出すことさえできるかもしれん」

くまたんたちは、さっそく変分オートエンコーダに、ステラの心の彫像を託しました。
しばらくして、AIの画面に映し出されたのは、キラキラと光る、小さな点の集まりでした。
その点の地図には、二つの大きな塊があります。片方には『理想を失った悲しみ』と、そしてもう片方には『何かを失うことへの、強い恐怖』と書かれていました。

二つの感情は、まるで引き合うように、しかし決して交わることなく、そこに存在していました。
それを見て、くまたんたちは、はっきりと理解しました。
ステラに必要なのは、論理で打ち負かすことではない。彼女の心の中にある、その二つの悲しいミニチュア像を、そっと包み込んであげることなのかもしれない、と。

森の仲間たちの、最後の挑戦の目的が、この瞬間、決まったのでした。

（第36話につづく）

## 第36話 ハッピークッキーパラダイス！

ステラの心の奥にある、悲しくて、でもとても人間らしい二つの感情。
その本質に触れた森の仲間たちの心には、不思議な静けさが満ちていました。戦うのではなく、寄り添う。そのための方法を、これから探していけばいい。未来への道筋が、ぼんやりと、しかし確かに見えた気がしました。

「…さて、と！」
沈黙を破ったのは、うさぎさんでした。彼女はにっこり笑うと、エプロンできゅっと手を拭きます。
「しんみりするのは、これでおしまい！ 私たちには、やるべきことがありますわ！」
そう、クッキーショップの開店準備です！

みんなは顔を見合わせ、ふふふ、と笑い合いました。
お店に戻ると、そこには甘い香りと、やるべきことがたくさん待っていました。リスくんは看板のデザインを考え、うさぎさんは新しいクッキーの試作をはじめ、くまたんはレジの最終調整に入ります。

「そうだ、看板に載せるクッキーの写真、AIにも選んでもらおうよ！」
くまたんが提案し、試作のクッキーを綺麗なお皿に並べて、何枚も写真を撮りました。

しかし、くまたんは少し心配そうな顔をします。
「でも、同じお皿で、同じ角度から撮った写真ばっかりだと、AIも良いデザインを思いつけないかもしれない…。もっとたくさんの種類の写真があれば、AIも『こんな飾り付けはどう？』とか、新しいアイデアを出してくれるかもしれないのに…」

その時、紅茶を飲んでいたホワイトタイガーおばあちゃんが、穏やかに言いました。
「くまたん、それこそが、AIの学習の最後の仕上げじゃよ。もしデータが足りなくても、AIが自分でデータを増やす、魔法のような分身の術があるんじゃ」
「分身の術！？」

「そうじゃ。『**データ拡張（Data Augmentation）**』と言う」
おばあちゃんは、くまたんが撮った一枚の写真を取り上げました。
「AIは、この一枚の写真を、ほんの少しだけ回転させたり、左右反転させたり、少しだけ拡大したり、明るさを変えたりして、何十枚もの『ちょっとだけ違う、新しい写真』を自分で作り出すことができるんじゃよ」

「わあ、すごい！ 人間の目には同じクッキーに見えても、AIにとっては全部、新しい学習データになるんだね！」
「その通り。おかげでAIは、たとえ少ないデータからでも、たくさんのことを学んで、より賢く、より柔軟になることができる。まるで、一枚のクッキーから、無限の可能性を引き出すようじゃな」

その言葉に、うさぎさんがはっとしたように顔を上げました。
「無限の可能性…」
彼女は、ペンギンさんから聞いた、ステラの「D-COOKIEアーキテクチャ」のことを思い出していました。クッキーという、みんなを幸せにするはずの名前が、世界を支配するかもしれないAIに使われている。それは、とても悲しいことでした。

「私、決めましたわ」
うさぎさんは、決意を込めて、みんなの顔を見渡します。
「私たちのクッキーショップは、AIと一緒に、みんなを幸せにする場所にしたい。だから、お店の名前は…『ハッピークッキーパラダイス』というのは、どうかしら！」

ハッピークッキーパラダイス！
その名前を聞いた瞬間、森の仲間たちの顔が、ぱあっと明るくなりました。
くまたんも、リスくんも、おばあちゃんも、満場一致でうなずきます。

AIは、使い方を間違えれば、世界を悲しくさせてしまうかもしれない。
でも、森の仲間たちと、この「ハッピークッキーパラダイス」から始まる物語は、きっとAIとの、温かくて幸せな未来に繋がっているはず。

みんなは、新しくできるお店の看板を思い浮かべながら、希望に満ちた笑顔で、空を見上げるのでした。

**（第5章 ディープラーニングの要素技術　おわり）**

（第6章につづく）

